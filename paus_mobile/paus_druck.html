<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>PAUS Druck</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
/* =========================================================
   BASIS â€“ KEIN UI, KEIN SCROLL, KEIN SCALE
========================================================= */
html, body {
    margin: 0;
    padding: 0;
    background: white;
}

/* =========================================================
   DRUCKSEITE (Android sieht A6 HOCH)
========================================================= */
@page {
    size: A6 portrait;
    margin: 0;
}

/* =========================================================
   DRUCKBEREICH (wird auf QUER gedreht)
========================================================= */
#page {
    width: 105mm;
    height: 148mm;

    transform: translateX(105mm) rotate(90deg);
    transform-origin: top left;

    box-sizing: border-box;
    position: relative;
    padding: 8mm;
}

/* =========================================================
   INHALT â€“ MITTE OHNE LOGO
========================================================= */
.content {
    position: absolute;
    top: 8mm;
    left: 8mm;
    right: 8mm;
    bottom: 30mm; /* ðŸ”¥ Platz fÃ¼r Logo */

    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    font-weight: bold;
}

/* =========================================================
   LOGO â€“ UNTEN RECHTS
========================================================= */
.logo {
    position: absolute;
    right: 8mm;
    bottom: 6mm;
    width: 40mm;
}

/* =========================================================
   TEXT
========================================================= */
.line-title       { font-size: 40pt; }
.line-kommission  { font-size: 48pt; }
.line-date        { font-size: 48pt; margin-top: 2mm; }
.line-vorgezogen  { font-size: 40pt; margin-top: 2mm; }

.date-past {
    border: 3px solid red;
    padding: 1px 8px;
    border-radius: 6px;
    display: inline-block;
}
</style>
</head>

<body>

<div id="page">
    <div id="content" class="content"></div>
    <img src="langen.png" class="logo">
</div>

<script>
(() => {
    const qs = new URLSearchParams(location.search);
    const data = JSON.parse(decodeURIComponent(qs.get("data") || "{}"));

    const kom = data.kommission || "";
    const dat = data.lieferdatum || "";
    const farbe = data.farbe || "#000";
    const vorgezogen = data.vorgezogen;

    let isPast = false;
    let finalDate = dat;

    if (dat) {
        let clean = dat.replace(/\s/g, "");
        let d = clean.slice(0,2);
        let m = clean.slice(2,4);
        if (clean.includes(".")) [d,m] = clean.split(".");

        const now = new Date();
        const target = new Date(now.getFullYear(), parseInt(m)-1, parseInt(d));
        const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
        const diff = (today.getFullYear()-target.getFullYear())*12 + (today.getMonth()-target.getMonth());

        if (target < today && diff < 2) isPast = true;
        finalDate = `${d.padStart(2,"0")}.${m.padStart(2,"0")}`;
    }

    let html = `
        <div class="line-title">PAUS</div>
        <div class="line-kommission" style="color:${farbe};">${kom}</div>
        <div class="line-date">
            <span class="${isPast ? "date-past" : ""}">${finalDate}</span>
        </div>
    `;

    if (vorgezogen) {
        html += `<div class="line-vorgezogen" style="color:${farbe};">â€žVorgezogenâ€œ</div>`;
    }

    document.getElementById("content").innerHTML = html;

    // ðŸ”¥ WICHTIG: sofort drucken â†’ Android erkennt Dokument
    setTimeout(() => window.print(), 150);
})();
</script>

</body>
</html>
