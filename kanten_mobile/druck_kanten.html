<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<title>Druck – Kanten / Schweißen / Bohrwerk (A5 quer)</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>
html, body {
  margin: 0;
  padding: 0;
  background: #dcdcdc;
  font-family: Arial, sans-serif;
  height: 100%;
  overflow: hidden;
}

/* =======================
   VORSCHAU (A5 QUER)
======================= */
.preview-wrapper {
  width: 100%;
  height: calc(100% - 180px);
  display: flex;
  justify-content: center;
  align-items: center;
}

.preview-area {
  width: 210mm;      /* A5 landscape */
  height: 148mm;     /* A5 landscape */
  background: #fff;
  border: 1px solid #bbb;
  box-shadow: 0 0 12px rgba(0,0,0,0.35);
  transform-origin: center;
}

/* Vorschau-Skalierung */
@media (max-width: 900px) { .preview-area { transform: scale(0.45); } }
@media (min-width: 901px) { .preview-area { transform: scale(0.60); } }

.etikett {
  width: 210mm;
  height: 148mm;
  padding: 10mm;
  box-sizing: border-box;
}

.etikett-center {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

.etikett-center div {
  font-weight: bold;
  width: 100%;
}

/* =======================
   BUTTONS
======================= */
.bottom-bar {
  height: 70px;
  display: flex;
  gap: 16px;
  padding: 10px 18px;
}

.btn {
  flex: 1;
  border: none;
  border-radius: 14px;
  font-size: 20px;
  color: white;
  font-weight: bold;
}

.back-btn  { background:#444; }
.print-btn { background:#15803d; }

/* =======================
   DRUCK FIX (ANDROID/MOPRIA)
   WICHTIG: KEIN redirect onafterprint,
   sonst druckt Android manchmal "die nächste Seite".
======================= */
.print-only { display: none; }

@media print {
  html, body {
    width: 210mm !important;
    height: 148mm !important;
    margin: 0 !important;
    padding: 0 !important;
    background: white !important;
    overflow: visible !important;
  }

  .preview-wrapper,
  .bottom-bar {
    display: none !important;
  }

  .print-only {
    display: block !important;
  }

  #printArea {
    display: block !important;
    width: 210mm !important;
    height: 148mm !important;
  }

  @page {
    size: A5 landscape;
    margin: 0;
  }
}
</style>
</head>

<body>

<!-- ===== VORSCHAU ===== -->
<div class="preview-wrapper">
  <div class="preview-area">
    <div class="etikett">
      <div class="etikett-center" id="previewContent"></div>
    </div>
  </div>
</div>

<!-- ===== DRUCKBEREICH (nur im Print sichtbar) ===== -->
<div id="printArea" class="etikett print-only">
  <div class="etikett-center" id="printContent"></div>
</div>

<!-- ===== BUTTONS ===== -->
<div class="bottom-bar">
  <button class="btn back-btn" id="backBtn">◀ Zurück</button>
  <button class="btn print-btn" id="printBtn">Drucken</button>
</div>

<script>
const qs    = new URLSearchParams(location.search);
const kunde = qs.get("kunde") || "Sonstige Kunden";
const art   = qs.get("art")   || "kanten";

/* ================== BOHRWERK PARAMETER ================== */
const BW_KUNDE_SIZE = "50pt";
const BW_KREIS_SIZE = "60mm";
const BW_TEXT_SIZE  = "30mm";
const BW_ABSTAND    = "14mm";

/* ================== KANTEN ================== */
const kantenLayouts = {
  "Backhus": [
    { text:"<kunde>", size:"48pt", marginTop:"0mm",  align:"center" },
    { text:"Kanten",  size:"48pt", marginTop:"10mm", align:"center" },
    { text:"K-Termin: _____________________",   size:"28pt", marginTop:"18mm", align:"left" },
    { text:"Palettennummer: _______________",  size:"28pt", marginTop:"26mm", align:"left" }
  ],
  "Bergmann M-H": [
    { text:"<kunde>", size:"48pt", marginTop:"0mm",  align:"center" },
    { text:"Kanten",  size:"48pt", marginTop:"10mm", align:"center" },
    { text:"K-Termin: _____________________",   size:"28pt", marginTop:"18mm", align:"left" },
    { text:"Palettennummer: _______________",  size:"28pt", marginTop:"26mm", align:"left" }
  ],
  "Bücker": [
    { text:"<kunde>", size:"48pt", marginTop:"0mm",  align:"center" },
    { text:"Kanten",  size:"48pt", marginTop:"10mm", align:"center" },
    { text:"K-Termin: _____________________",   size:"28pt", marginTop:"18mm", align:"left" },
    { text:"Palettennummer: _______________",  size:"28pt", marginTop:"26mm", align:"left" }
  ],
  "FVG": [
    { text:"<kunde>", size:"48pt", marginTop:"0mm",  align:"center" },
    { text:"Kanten",  size:"48pt", marginTop:"10mm", align:"center" },
    { text:"K-Termin: _____________________",   size:"28pt", marginTop:"18mm", align:"left" },
    { text:"Palettennummer: _______________",  size:"28pt", marginTop:"26mm", align:"left" }
  ],
  "Grimme": [
    { text:"<kunde>", size:"48pt", marginTop:"0mm",  align:"center" },
    { text:"Kanten",  size:"48pt", marginTop:"10mm", align:"center" },
    { text:"K-Termin: _____________________",   size:"28pt", marginTop:"18mm", align:"left" },
    { text:"Palettennummer: _______________",  size:"28pt", marginTop:"26mm", align:"left" }
  ],
  "Janzen": [
    { text:"<kunde>", size:"48pt", marginTop:"0mm",  align:"center" },
    { text:"Kanten",  size:"48pt", marginTop:"10mm", align:"center" },
    { text:"K-Termin: _____________________",   size:"28pt", marginTop:"18mm", align:"left" },
    { text:"Palettennummer: _______________",  size:"28pt", marginTop:"26mm", align:"left" }
  ],
  "Krone Spelle": [
    { text:"<kunde>", size:"48pt", marginTop:"0mm",  align:"center" },
    { text:"Kanten",  size:"48pt", marginTop:"10mm", align:"center" },
    { text:"K-Termin: _____________________",   size:"28pt", marginTop:"18mm", align:"left" },
    { text:"Palettennummer: _______________",  size:"28pt", marginTop:"26mm", align:"left" }
  ],
  "L. Bergmann": [
    { text:"<kunde>", size:"48pt", marginTop:"0mm",  align:"center" },
    { text:"Kanten",  size:"48pt", marginTop:"10mm", align:"center" },
    { text:"K-Termin: _____________________",   size:"28pt", marginTop:"18mm", align:"left" },
    { text:"Palettennummer: _______________",  size:"28pt", marginTop:"26mm", align:"left" }
  ],
  "PAUS": [
    { text:"<kunde>", size:"48pt", marginTop:"0mm",  align:"center" },
    { text:"Kanten",  size:"48pt", marginTop:"10mm", align:"center" },
    { text:"K-Termin: _____________________", size:"28pt", marginTop:"18mm", align:"left" }
  ],
  "TOS": [
    { text:"<kunde>", size:"48pt", marginTop:"0mm",  align:"center" },
    { text:"Kanten",  size:"48pt", marginTop:"10mm", align:"center" }
  ],
  "Sonstige Kunden": [
    { text:"<kunde>", size:"48pt", marginTop:"0mm",  align:"center" },
    { text:"Kanten",  size:"48pt", marginTop:"10mm", align:"center" },
    { text:"K-Termin: _____________________",   size:"28pt", marginTop:"18mm", align:"left" },
    { text:"Palettennummer: _______________",  size:"28pt", marginTop:"26mm", align:"left" }
  ]
};

/* ================== SCHWEISSEN (ALLES DRIN) ================== */
const schweissenLayouts = {
  "Bergmann M-H": [
    { text:"<kunde>", size:"48pt", marginTop:"0mm", align:"center" },
    { text:"Schweißen", size:"28pt", marginTop:"10mm", align:"center" },
    { text:"Auftr. Nr: __________________________", size:"24pt", marginTop:"14mm", align:"left" },
    { text:"Pos. Nr: ___________________________",  size:"24pt", marginTop:"12mm", align:"left" },
    { text:"SW-Termin: ________________________",   size:"24pt", marginTop:"12mm", align:"left" }
  ],
  "Backhus": [
    { text:"<kunde>", size:"46pt", marginTop:"0mm", align:"center" },
    { text:"Schweißen", size:"42pt", marginTop:"10mm", align:"center" },
    { text:"SW-Termin: _____________________", size:"30pt", marginTop:"18mm", align:"left" }
  ],
  "Bücker": [
    { text:"<kunde>", size:"46pt", marginTop:"0mm", align:"center" },
    { text:"Schweißen", size:"42pt", marginTop:"10mm", align:"center" },
    { text:"SW-Termin: ___________________", size:"30pt", marginTop:"18mm", align:"left" }
  ],
  "FVG": [
    { text:"<kunde>", size:"46pt", marginTop:"0mm", align:"center" },
    { text:"Schweißen", size:"42pt", marginTop:"10mm", align:"center" },
    { text:"SW-Termin: ___________________", size:"30pt", marginTop:"18mm", align:"left" }
  ],
  "Grimme": [
    { text:"<kunde>", size:"46pt", marginTop:"0mm", align:"center" },
    { text:"Schweißen", size:"42pt", marginTop:"10mm", align:"center" },
    { text:"SW-Termin: ___________________", size:"30pt", marginTop:"18mm", align:"left" }
  ],
  "Janzen": [
    { text:"<kunde>", size:"46pt", marginTop:"0mm", align:"center" },
    { text:"Schweißen", size:"42pt", marginTop:"10mm", align:"center" },
    { text:"SW-Termin: ___________________", size:"30pt", marginTop:"18mm", align:"left" }
  ],
  "Krone Spelle": [
    { text:"<kunde>", size:"48pt", marginTop:"0mm", align:"center" },
    { text:"Schweißen", size:"28pt", marginTop:"0mm", align:"center" },
    { text:"Auftr--Nr: _________________________", size:"24pt", marginTop:"10mm", align:"left" },
    { text:"Bezeichnung: ______________________",  size:"24pt", marginTop:"12mm", align:"left" },
    { text:"Stückzahl: ________\u00A0\u00A0\u00A0\u00A0\u00A0KW-SW: _______", size:"24pt", marginTop:"12mm", align:"left" },
    { text:"Liefertermin: _______________________", size:"24pt", marginTop:"12mm", align:"left" }
  ],
  "L. Bergmann": [
    { text:"<kunde>", size:"46pt", marginTop:"0mm", align:"center" },
    { text:"Schweißen", size:"42pt", marginTop:"10mm", align:"center" },
    { text:"SW-Termin: ___________________", size:"30pt", marginTop:"18mm", align:"left" }
  ],
  "PAUS": [
    { text:"<kunde>", size:"46pt", marginTop:"0mm", align:"center" },
    { text:"Schweißen", size:"42pt", marginTop:"10mm", align:"center" },
    { text:"SW-Termin: ___________________", size:"30pt", marginTop:"18mm", align:"left" }
  ],
  "TOS": [
    { text:"<kunde>", size:"46pt", marginTop:"0mm", align:"center" },
    { text:"Schweißen", size:"42pt", marginTop:"10mm", align:"center" },
    { text:"SW-Termin: ____________________", size:"30pt", marginTop:"18mm", align:"left" }
  ],
  "Sonstige Kunden": [
    { text:"<kunde>", size:"46pt", marginTop:"0mm", align:"center" },
    { text:"Schweißen", size:"42pt", marginTop:"10mm", align:"center" },
    { text:"SW-Termin: ___________________", size:"30pt", marginTop:"18mm", align:"left" }
  ]
};

/* ================== BOHRWERK ================== */
const bohrwerkLayouts = {
  "Sonstige Kunden": [
    { text:"<kunde>", size:BW_KUNDE_SIZE, marginTop:"0mm", align:"center" },
    { text:"BW", size:BW_TEXT_SIZE, marginTop:BW_ABSTAND, align:"center", circle:true }
  ]
};

function render(rows) {
  return rows.map(r => {
    if (r.circle) {
      return `
        <div style="
          margin:${r.marginTop} auto 0;
          width:${BW_KREIS_SIZE};
          height:${BW_KREIS_SIZE};
          border:5px solid black;
          border-radius:50%;
          display:flex;
          align-items:center;
          justify-content:center;
          font-size:${r.size};
        ">${r.text}</div>`;
    }
    return `
      <div style="font-size:${r.size}; margin-top:${r.marginTop}; text-align:${r.align};">
        ${r.text.replace("<kunde>", kunde)}
      </div>`;
  }).join("");
}

/* ================== AUSGABE ================== */
let layouts = kantenLayouts;
if (art === "schweissen") layouts = schweissenLayouts;
if (art === "bohrwerk")   layouts = bohrwerkLayouts;

const html = render(layouts[kunde] || layouts["Sonstige Kunden"]);
document.getElementById("previewContent").innerHTML = html;
document.getElementById("printContent").innerHTML   = html;

/* ================== DRUCK ==================
   Kein window.onafterprint redirect (macht auf Android oft falschen Druckinhalt)
*/
document.getElementById("printBtn").onclick = () => {
  setTimeout(() => window.print(), 120);
};

document.getElementById("backBtn").onclick = () => {
  location.replace("../index.html");
};
</script>

</body>
</html>
